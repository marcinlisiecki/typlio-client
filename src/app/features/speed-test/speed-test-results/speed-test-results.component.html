<section class="mt-from-header">
  <header>
    <app-page-heading [steps]="['SPEED TEST', modeLabel.toUpperCase(), 'RESULTS']"
      >Typing speed test results</app-page-heading
    >
  </header>

  <section class="mt-20">
    <div class="flex gap-x-16">
      <div class="flex-[2]">
        <div class="flex justify-between items-center">
          <div class="flex items-end gap-x-2">
            <p class="text-4xl text-primary-500 font-semibold">
              {{ Math.round(stats.cpm / 5) }}
            </p>
            <p class="text-text-secondary font-bold font-mono tracking-wide pb-px">WPM</p>
          </div>

          <div class="flex items-end gap-x-2">
            <p class="text-4xl text-primary-500 font-semibold">
              {{ stats.cpm }}
            </p>
            <p class="text-text-secondary font-bold font-mono tracking-wide pb-px">CPM</p>
          </div>

          <div class="flex items-end gap-x-2">
            <p class="text-4xl text-primary-500 font-semibold">{{ stats.accuracy }}%</p>
            <p class="text-text-secondary font-bold font-mono tracking-wide pb-px">ACCURACY</p>
          </div>

          <div class="flex items-end gap-x-2">
            <p class="text-4xl text-primary-500 font-semibold">{{ time }}s</p>
            <p class="text-text-secondary font-bold font-mono tracking-wide pb-px">TIME</p>
          </div>
        </div>

        <div class="mt-6" *ngIf="chartData !== null">
          <canvas
            class="w-full h-64"
            height="300px"
            baseChart
            [type]="'line'"
            [data]="chartData"
            [options]="DEFAULT_LINE_CHART_OPTIONS"
            [legend]="false"
          ></canvas>
        </div>

        <div class="mt-6 flex gap-x-4 items-center">
          <app-icon-button
            (click)="nextSpeedTest.emit()"
            icon="pi pi-angle-double-right"
            helpText="Next speed test"
          ></app-icon-button>
          <app-icon-button
            (click)="repeatSameSpeedTest.emit()"
            icon="pi pi-refresh"
            helpText="Repeat the same"
          ></app-icon-button>
          <a routerLink="/speed-test">
            <app-icon-button
              icon="pi pi-arrow-right-arrow-left"
              helpText="Change mode"
            ></app-icon-button>
          </a>
        </div>
      </div>

      <div class="flex w-px bg-gray-900 min-h-full"></div>

      <div class="flex-[1] flex flex-col justify-between">
        <div>
          <p class="text-text-secondary font-bold font-mono tracking-wide pb-px">MODE</p>
          <p>{{ modeLabel }}</p>
        </div>

        <div>
          <div class="flex items-center gap-x-2" *ngIf="!saved && !savingError">
            <app-spinner></app-spinner>
            <p class="text-text-secondary ml-1">Saving results.</p>
          </div>

          <div class="flex items-center gap-x-2" *ngIf="saved">
            <i class="pi pi-check-circle text-green-500"></i>
            <p class="text-green-500">Results saved.</p>
          </div>

          <div class="flex items-center gap-x-2" *ngIf="savingError">
            <i class="pi pi-exclamation-circle text-red-500"></i>
            <p class="text-red-500">{{ savingError }}</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</section>
